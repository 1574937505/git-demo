# 灵魂交友产品需求文档 (PRD)

## 文档信息

| 项目 | 内容 |
|------|------|
| 产品名称 | 灵魂交友 (暂定) |
| 文档版本 | v1.0 |
| 创建日期 | 2025-12-28 |
| 文档状态 | 初稿 |

---

## 1. 产品概述

### 1.1 产品背景

当前社交市场上的交友产品大多以"颜值优先"为核心，用户通过照片进行快速筛选，导致社交关系浮于表面。年轻人群体（18-30岁）越来越渴望找到真正懂自己、三观一致、能够深度交流的朋友或伴侣。

### 1.2 产品定位

**灵魂交友**是一款面向18-30岁年轻人的深度社交平台，强调"先懂灵魂，再看外表"的交友理念。通过性格测试、兴趣标签、AI智能匹配和问答互动等多维度机制，帮助用户找到真正契合的灵魂伙伴。

### 1.3 产品愿景

让每个人都能找到懂自己的灵魂伙伴。

### 1.4 目标用户

| 用户特征 | 描述 |
|----------|------|
| 年龄范围 | 18-30岁 |
| 核心群体 | 大学生、职场新人、单身青年 |
| 用户痛点 | 厌倦浅层社交、渴望深度连接、不想以貌取人 |
| 用户需求 | 找到三观一致的朋友/恋人、有质量的对话、真诚的交流 |

---

## 2. 产品架构

### 2.1 平台覆盖

- **iOS App** (iPhone)
- **Android App**
- **Web端** (响应式设计，支持PC和平板)

### 2.2 技术栈

| 层级 | 技术选型 |
|------|----------|
| 后端框架 | Spring Boot 3.x |
| 安全框架 | Spring Security + JWT |
| 权限管理 | RBAC（基于角色的访问控制） |
| ORM框架 | MyBatis-Plus |
| 数据库 | MySQL 8.0 |
| 缓存 | Redis |
| 搜索引擎 | Elasticsearch |
| 消息队列 | RabbitMQ / Kafka |
| 文件存储 | OSS（阿里云/腾讯云） |
| API文档 | Swagger / Knife4j |
| 构建工具 | Maven / Gradle |

### 2.3 技术架构概述

```
┌─────────────────────────────────────────────────────┐
│                    客户端                            │
│  ┌─────────┐  ┌─────────┐  ┌─────────────────────┐ │
│  │ iOS App │  │ Android │  │      Web端          │ │
│  └─────────┘  └─────────┘  └─────────────────────┘ │
└─────────────────────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────┐
│              API Gateway (Spring Cloud Gateway)      │
└─────────────────────────────────────────────────────┘
                         │
                         ▼
┌─────────────────────────────────────────────────────┐
│              Spring Security + JWT + RBAC            │
└─────────────────────────────────────────────────────┘
                         │
    ┌────────────────────┼────────────────────┐
    ▼                    ▼                    ▼
┌─────────┐      ┌─────────────┐      ┌─────────────┐
│用户服务 │      │ 匹配服务    │      │  消息服务   │
│SpringBoot│     │ SpringBoot  │      │ SpringBoot  │
└─────────┘      └─────────────┘      └─────────────┘
    │                    │                    │
    ▼                    ▼                    ▼
┌─────────────────────────────────────────────────────┐
│                    数据层                            │
│  ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌───────┐ │
│  │ MySQL   │  │ Redis   │  │ MongoDB │  │ ES    │ │
│  └─────────┘  └─────────┘  └─────────┘  └───────┘ │
└─────────────────────────────────────────────────────┘
```

### 2.4 RBAC权限模型设计

#### 2.4.1 权限模型概述

采用标准RBAC（Role-Based Access Control）模型，实现用户-角色-权限的三级控制。

```
┌──────────┐      ┌──────────┐      ┌──────────┐
│   用户   │ ──── │   角色   │ ──── │   权限   │
│  (User)  │ M:N  │  (Role)  │ M:N  │(Permission)│
└──────────┘      └──────────┘      └──────────┘
```

#### 2.4.2 数据库表设计

**用户表 (sys_user)**
| 字段 | 类型 | 说明 |
|------|------|------|
| id | bigint | 主键 |
| username | varchar(50) | 用户名 |
| password | varchar(100) | 密码（BCrypt加密） |
| phone | varchar(20) | 手机号 |
| email | varchar(100) | 邮箱 |
| status | tinyint | 状态：0禁用 1启用 |
| create_time | datetime | 创建时间 |
| update_time | datetime | 更新时间 |

**角色表 (sys_role)**
| 字段 | 类型 | 说明 |
|------|------|------|
| id | bigint | 主键 |
| role_code | varchar(50) | 角色编码 |
| role_name | varchar(50) | 角色名称 |
| description | varchar(200) | 描述 |
| status | tinyint | 状态：0禁用 1启用 |
| create_time | datetime | 创建时间 |

**权限表 (sys_permission)**
| 字段 | 类型 | 说明 |
|------|------|------|
| id | bigint | 主键 |
| permission_code | varchar(100) | 权限编码 |
| permission_name | varchar(50) | 权限名称 |
| type | tinyint | 类型：1菜单 2按钮 3接口 |
| parent_id | bigint | 父级ID |
| path | varchar(200) | 路由路径 |
| api_url | varchar(200) | 接口URL |
| method | varchar(10) | 请求方法 |
| sort | int | 排序 |

**用户角色关联表 (sys_user_role)**
| 字段 | 类型 | 说明 |
|------|------|------|
| id | bigint | 主键 |
| user_id | bigint | 用户ID |
| role_id | bigint | 角色ID |

**角色权限关联表 (sys_role_permission)**
| 字段 | 类型 | 说明 |
|------|------|------|
| id | bigint | 主键 |
| role_id | bigint | 角色ID |
| permission_id | bigint | 权限ID |

#### 2.4.3 系统角色定义

| 角色编码 | 角色名称 | 权限范围 |
|----------|----------|----------|
| ROLE_SUPER_ADMIN | 超级管理员 | 所有权限 |
| ROLE_ADMIN | 普通管理员 | 用户管理、内容审核、数据统计 |
| ROLE_OPERATOR | 运营人员 | 内容审核、活动管理、推送管理 |
| ROLE_AUDITOR | 审核员 | 内容审核、举报处理 |
| ROLE_USER | 普通用户 | App端所有用户功能 |
| ROLE_VIP_USER | VIP用户 | 普通用户权限+VIP特权（预留） |

#### 2.4.4 权限控制粒度

**接口级权限控制**
```java
// 示例：使用注解进行权限控制
@PreAuthorize("hasPermission('user:list')")
@GetMapping("/users")
public Result<List<User>> listUsers() { ... }

@PreAuthorize("hasRole('ADMIN')")
@DeleteMapping("/users/{id}")
public Result<Void> deleteUser(@PathVariable Long id) { ... }
```

**数据级权限控制**
- 普通用户只能查看/修改自己的数据
- 管理员可查看所有用户数据
- 审核员只能查看待审核内容

#### 2.4.5 权限模块列表

| 模块 | 权限编码 | 说明 |
|------|----------|------|
| 用户管理 | user:list, user:add, user:edit, user:delete, user:ban | 用户CRUD及封禁 |
| 角色管理 | role:list, role:add, role:edit, role:delete | 角色CRUD |
| 权限管理 | permission:list, permission:add, permission:edit | 权限配置 |
| 内容审核 | audit:list, audit:pass, audit:reject | 内容审核操作 |
| 举报处理 | report:list, report:handle | 举报处理 |
| 数据统计 | stats:view, stats:export | 数据查看与导出 |
| 活动管理 | activity:list, activity:add, activity:edit | 活动CRUD |
| 推送管理 | push:send, push:list | 消息推送 |
| 系统配置 | config:view, config:edit | 系统参数配置 |

---

## 3. 功能模块详细设计

### 3.1 用户模块

#### 3.1.1 注册登录

| 功能点 | 描述 | 优先级 |
|--------|------|--------|
| 手机号注册 | 支持国内手机号+短信验证码注册 | P0 |
| 微信登录 | 支持微信授权快捷登录 | P0 |
| QQ登录 | 支持QQ授权登录 | P1 |
| Apple登录 | iOS端支持Apple ID登录 | P1 |
| 账号密码登录 | 支持设置密码后使用密码登录 | P2 |

#### 3.1.2 个人资料

**基础信息**
- 昵称（必填，2-12字符）
- 性别（必填，男/女/保密）
- 生日（必填，用于年龄计算）
- 所在城市（选填）
- 职业（选填）
- 学历（选填）
- 个性签名（选填，最多100字）

**头像与相册**
- 头像（初期可选择系统头像或不上传真人照片）
- 照片墙（最多9张，可设置查看权限：公开/仅好友/仅自己）
- 照片模糊化功能（深度了解后才能解锁清晰照片）

**灵魂标签**
- 用户可选择/创建最多20个标签
- 标签分类：性格特点、兴趣爱好、生活方式、恋爱观、价值观

#### 3.1.3 实名认证

| 认证类型 | 描述 | 权益 |
|----------|------|------|
| 手机认证 | 绑定手机号 | 基础功能使用 |
| 身份认证 | 身份证OCR+人脸识别 | 获得认证标识 |
| 学历认证 | 学信网验证/毕业证上传 | 获得学历标识 |
| 职业认证 | 工作证明上传审核 | 获得职业标识 |

---

### 3.2 灵魂匹配模块（核心功能）

#### 3.2.1 性格测试系统

**MBTI性格测试**
- 93道标准测试题
- 生成16种人格类型结果
- 展示用户性格特点、优势、交友建议
- 可重新测试（每月限1次）

**恋爱风格测试**
- 30道题目
- 生成依恋类型：安全型、焦虑型、回避型、恐惧型
- 给出恋爱建议和注意事项

**价值观测试**
- 20道情景选择题
- 覆盖：金钱观、家庭观、事业观、社交观
- 生成价值观画像

**自定义心理测试**
- 后台可配置新测试
- 支持定期更新趣味测试

#### 3.2.2 兴趣标签匹配

**标签体系**

```
├── 音乐
│   ├── 流行、摇滚、民谣、电子、古典、嘻哈、R&B...
├── 影视
│   ├── 电影、美剧、日剧、韩剧、动漫、纪录片...
├── 阅读
│   ├── 文学、历史、哲学、心理、科幻、推理...
├── 运动
│   ├── 跑步、健身、游泳、篮球、瑜伽、滑雪...
├── 游戏
│   ├── 手游、PC游戏、主机游戏、桌游...
├── 旅行
│   ├── 自驾、徒步、海岛、城市、露营...
├── 美食
│   ├── 烹饪、探店、烘焙、咖啡、茶道...
├── 艺术
│   ├── 绘画、摄影、设计、手工...
├── 其他
│   ├── 宠物、星座、二次元、科技...
```

**匹配规则**
- 标签相似度计算
- 权重分配（用户可设置标签重要程度）
- 相似度达60%以上才进入推荐池

#### 3.2.3 AI智能匹配

**数据采集维度**
- 用户填写的个人资料
- 性格测试结果
- 兴趣标签选择
- 用户行为数据（浏览、点赞、聊天时长）
- 问答互动内容

**匹配算法**
- 基于深度学习的用户画像建模
- 协同过滤推荐
- 知识图谱关联分析
- 实时调整匹配策略

**匹配结果展示**
- 灵魂契合度（百分比）
- 契合维度分析（性格、兴趣、价值观分别匹配度）
- 共同点展示
- 聊天话题推荐

#### 3.2.4 问答互动匹配

**灵魂问题库**
- 500+精选深度问题
- 问题分类：人生哲学、情感态度、生活方式、假设情境

**问题示例**
```
- 如果可以和任何人共进晚餐，你会选择谁？
- 你最后一次对着别人哭是什么时候？
- 你觉得最完美的一天是怎样的？
- 如果明天醒来发现获得了一种新能力，你希望是什么？
- 你最珍贵的回忆是什么？
- 你会和最好的朋友分享什么秘密？
```

**互动机制**
- 每日推送3个灵魂问题
- 用户回答后可查看其他用户的回答
- 可对喜欢的回答点赞、评论
- 通过问答发现三观一致的人

---

### 3.3 社交互动模块

#### 3.3.1 发现页

**推荐列表**
- 基于匹配算法推荐的用户卡片
- 展示：昵称、年龄、城市、契合度、共同标签
- 左滑跳过，右滑表示感兴趣

**筛选条件**
- 性别
- 年龄范围
- 地区
- 在线状态
- 认证状态

#### 3.3.2 灵魂广场

**内容类型**
- 文字动态（最多500字）
- 图片动态（最多9张）
- 问答卡片（分享自己的问题回答）
- 音乐分享（支持网易云、QQ音乐链接）

**互动功能**
- 点赞
- 评论（支持二级评论）
- 分享到聊天
- 收藏

**内容审核**
- AI自动审核+人工复审
- 敏感词过滤
- 图片审核（涉黄、涉政、暴力）

#### 3.3.3 私信聊天

**消息类型**
| 类型 | 描述 |
|------|------|
| 文字消息 | 支持emoji、@功能 |
| 图片消息 | 支持拍照和相册选择 |
| 语音消息 | 最长60秒 |
| 视频消息 | 最长15秒 |
| 位置分享 | 发送当前位置或指定位置 |
| 名片分享 | 分享其他用户资料卡 |
| 灵魂问题 | 发送问题邀请对方回答 |

**聊天功能**
- 消息已读状态
- 消息撤回（2分钟内）
- 聊天记录搜索
- 消息免打扰
- 拉黑功能

**破冰机制**
- 双方互相感兴趣后才能发起聊天
- 系统推荐破冰话题
- 首次聊天有24小时有效期，超时未回复则关闭

#### 3.3.4 语音/视频通话

**功能支持**
- 一对一语音通话
- 一对一视频通话
- 通话时长统计
- 通话中可发送消息

**隐私保护**
- 视频通话可选模糊滤镜
- 支持仅语音模式
- 通话录音需双方同意

---

### 3.4 会员与变现模块

#### 3.4.1 商业模式

本产品采用**完全免费+广告变现**模式，所有核心功能对用户免费开放。

#### 3.4.2 广告位设计

| 广告位 | 位置 | 形式 | 频次 |
|--------|------|------|------|
| 启动页广告 | App启动时 | 全屏开屏广告 | 每次启动 |
| 信息流广告 | 发现页/广场 | 原生信息流 | 每10条内容1条 |
| Banner广告 | 个人中心底部 | 横幅广告 | 常驻 |
| 插屏广告 | 匹配成功时 | 弹窗广告 | 每3次匹配1次 |
| 激励视频 | 获取额外功能时 | 视频广告 | 用户主动触发 |

#### 3.4.3 激励视频场景

- 观看广告获得额外每日推荐次数
- 观看广告查看谁对我感兴趣
- 观看广告获得超级喜欢次数
- 观看广告解锁对方更多资料

#### 3.4.4 未来变现扩展（预留）

- VIP会员订阅（去广告、高级筛选、无限喜欢）
- 虚拟礼物系统
- 线下活动付费报名
- 专属皮肤/装扮

---

### 3.5 安全与隐私模块

#### 3.5.1 账号安全

- 登录设备管理
- 异常登录提醒
- 密码强度检测
- 账号申诉与找回

#### 3.5.2 内容安全

- 敏感词实时过滤
- 图片AI审核（涉黄、涉政、暴力、广告）
- 用户举报机制
- 违规内容24小时内处理

#### 3.5.3 隐私保护

| 功能 | 描述 |
|------|------|
| 隐身模式 | 开启后不会出现在他人推荐列表 |
| 黑名单 | 屏蔽指定用户，双方互不可见 |
| 位置隐藏 | 可选择隐藏具体城市 |
| 在线状态隐藏 | 可选择不显示在线状态 |
| 照片权限 | 可设置照片仅好友可见 |
| 数据导出 | 用户可导出个人数据 |
| 账号注销 | 支持永久删除账号及所有数据 |

#### 3.5.4 举报与处罚

**举报类型**
- 色情低俗
- 骚扰辱骂
- 虚假信息
- 诈骗行为
- 未成年人
- 其他

**处罚机制**
| 违规程度 | 处罚措施 |
|----------|----------|
| 轻度 | 警告+删除违规内容 |
| 中度 | 禁言1-7天 |
| 重度 | 封禁账号30天 |
| 严重 | 永久封禁+上报公安机关 |

---

### 3.6 运营模块

#### 3.6.1 消息推送

| 推送类型 | 场景 | 频次限制 |
|----------|------|----------|
| 匹配通知 | 有新的匹配成功 | 即时推送 |
| 消息通知 | 收到新消息 | 即时推送 |
| 互动通知 | 被点赞、评论 | 合并推送，每小时最多1次 |
| 活动通知 | 运营活动提醒 | 每天最多1次 |
| 召回通知 | 用户沉默超过3天 | 每周最多2次 |

#### 3.6.2 运营活动

- 每日签到
- 新用户引导任务
- 节日主题活动
- 话题讨论活动
- 线下见面会（未来规划）

#### 3.6.3 数据统计

**核心指标**
- DAU/MAU（日活/月活）
- 用户留存率（次日、7日、30日）
- 平均使用时长
- 匹配成功率
- 消息发送量
- 广告收入

---

## 4. 非功能性需求

### 4.1 性能要求

| 指标 | 要求 |
|------|------|
| 页面加载时间 | ≤2秒 |
| API响应时间 | ≤200ms（P99） |
| 消息送达延迟 | ≤500ms |
| 系统可用性 | ≥99.9% |
| 并发用户支持 | 10万+ |

### 4.2 兼容性要求

**移动端**
- iOS 12.0+
- Android 6.0+

**Web端**
- Chrome 80+
- Safari 13+
- Firefox 75+
- Edge 80+

### 4.3 安全要求

- 全站HTTPS传输
- 用户密码BCrypt加密存储
- 敏感数据AES加密
- API接口签名验证
- SQL注入防护
- XSS攻击防护
- 接口频率限制

### 4.4 合规要求

- 符合《个人信息保护法》
- 符合《网络安全法》
- App需通过应用商店审核
- 用户协议与隐私政策
- 未成年人保护机制

---

## 5. 用户旅程

### 5.1 新用户注册流程

```
下载App → 启动页浏览 → 选择登录方式 → 填写基础信息
    → 选择兴趣标签(至少5个) → 完成性格测试
    → 进入首页开始匹配
```

### 5.2 核心使用流程

```
打开App → 浏览推荐用户 → 右滑感兴趣
    → 双方互相喜欢 → 匹配成功 → 开始聊天
    → 深入了解 → 成为好友/恋人
```

### 5.3 日常使用场景

**场景一：寻找灵魂伴侣**
小明，25岁程序员，性格内向，喜欢阅读和游戏。通过性格测试发现自己是INFP型，系统推荐了几位同样是INFP或ENFJ（最佳匹配）的女生。通过问答互动，他发现小红对人生的思考和自己很像，两人开始聊天，越聊越投机。

**场景二：找志同道合的朋友**
小红，22岁大学生，刚到新城市读研，想找一些聊得来的朋友。她在灵魂广场发了一篇关于《百年孤独》读后感的动态，收到了几个同样喜欢马尔克斯的用户评论，大家组建了一个读书小群。

---

## 6. 产品路线图

### 6.1 MVP版本（第一阶段）

**核心功能**
- [x] 注册登录（手机号+微信）
- [x] 基础个人资料
- [x] MBTI性格测试
- [x] 兴趣标签系统
- [x] 基础匹配推荐
- [x] 私信聊天
- [x] 开屏广告+信息流广告

### 6.2 增强版本（第二阶段）

**新增功能**
- [ ] 更多性格测试
- [ ] AI智能匹配优化
- [ ] 灵魂广场
- [ ] 问答互动匹配
- [ ] 语音通话
- [ ] 更多广告位

### 6.3 完整版本（第三阶段）

**新增功能**
- [ ] 视频通话
- [ ] Web端上线
- [ ] 实名认证体系
- [ ] 数据分析平台
- [ ] 运营活动系统
- [ ] 线下活动模块

---

## 7. 风险评估

| 风险类型 | 风险描述 | 应对措施 |
|----------|----------|----------|
| 合规风险 | 社交产品审核严格 | 提前准备资质，内容审核机制完善 |
| 安全风险 | 用户数据泄露 | 加强安全防护，定期安全审计 |
| 运营风险 | 冷启动用户不足 | 种子用户运营，邀请机制 |
| 内容风险 | 低质量/违规内容 | AI+人工审核，举报机制 |
| 竞争风险 | 市场竞争激烈 | 差异化定位，深耕垂直领域 |

---

## 8. 成功指标

### 8.1 用户指标

| 指标 | 3个月目标 | 6个月目标 | 12个月目标 |
|------|-----------|-----------|------------|
| 注册用户 | 10万 | 50万 | 200万 |
| DAU | 1万 | 8万 | 40万 |
| 次日留存 | 40% | 45% | 50% |
| 7日留存 | 20% | 25% | 30% |

### 8.2 业务指标

| 指标 | 目标 |
|------|------|
| 匹配成功率 | ≥15% |
| 消息回复率 | ≥60% |
| 广告eCPM | ≥30元 |
| 人均使用时长 | ≥20分钟/天 |

---

## 9. 附录

### 9.1 竞品分析

| 产品 | 特点 | 优势 | 劣势 |
|------|------|------|------|
| Soul | 灵魂社交先驱 | 用户基数大，功能完善 | 内容质量下降，商业化严重 |
| 积目 | 潮流社交 | 年轻用户多，调性好 | 偏向外貌社交 |
| Uki | 语音社交 | 语音互动特色 | 功能相对单一 |
| 探探 | 外貌匹配 | 用户量大 | 完全颜值导向 |

### 9.2 术语说明

| 术语 | 解释 |
|------|------|
| MBTI | 迈尔斯-布里格斯类型指标，一种性格分类系统 |
| 灵魂契合度 | 基于多维度计算的用户匹配程度 |
| 破冰 | 首次与匹配用户建立联系 |
| DAU | Daily Active Users，日活跃用户数 |
| MAU | Monthly Active Users，月活跃用户数 |

---

## 修订记录

| 版本 | 日期 | 修订内容 | 修订人 |
|------|------|----------|--------|
| v1.0 | 2025-12-28 | 初稿创建 | - |
